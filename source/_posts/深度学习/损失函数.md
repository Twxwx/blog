---
title: 损失函数
date: 2024-03-03 17:47:51
categories:
    - 深度学习
tags:
---

## 交叉熵损失函数

- 本质上是一种对数似然函数，可用于二分类和多分类任务中

### 二分类问题

![](/img/note/202404011525.png)

```python
loss = -torch.sum(y * torch.log(probs) + (1 - y) * torch.log(1 - probs)).mean()
```

### 多分类问题

![](/img/note/202404011526.png)

```python
def cross_entropy(x: torch.Tensor, y: torch.Tensor):
    # x: (batch_size, num_classes) 经过softmax得到概率
    # y: (batch_size, num_classes) one-hot形式
    return -torch.sum(y * torch.log(x), dim=1).mean()

if __name__ == "__main__":
    input = torch.randn(4, 3)
    probs = softmax(input)
    labels = torch.tensor([0, 1, 2, 1], dtype=torch.int64)
    targets = F.one_hot(labels, num_classes = 3)
    # 不能讲概率作为输入
    loss1 = F.cross_entropy(input, labels)
    # 需要将label转化为one-hot形式
    loss2 = cross_entropy(probs, targets)
```





