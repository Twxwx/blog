---
title: 损失函数
date: 2024-03-03 17:47:51
categories:
    - 深度学习
tags:
---

## 交叉熵损失函数

- 本质上是一种对数似然函数，可用于二分类和多分类任务中

### 二分类问题

![](/img/note/202404011525.png)

```python
loss = -torch.sum(y * torch.log(probs) + (1 - y) * torch.log(1 - probs)).mean()
```

### 多分类问题

![](/img/note/202404011526.png)

```python
outputs = torch.randn(3, 4) # 3个样本，4个类别
probs = F.softmax(outputs, dim = 1) # 计算概率分布
labels = torch.tensor([1, 2, 3]) # 每个样本的真实标签分别为1、2、3
labels_one_hot = F.one_hot(labels, num_classes = 4) # 将真实标签转换为one-hot编码
loss = -torch.sum(labels_one_hot * torch.log(probs), dim = 1).mean()
```





