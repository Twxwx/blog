---
title: 推荐系统召回篇
date: 2024-02-04 17:35:25
categories:
    - 搜广推
tags:
---

## 召回层的作用和意义

- 召回阶段负责从海量数据中快速筛选出部分数据。
- 在精排阶段，一般会使用复杂的模型和特征，对上百万的候选集排序。
- 加入召回过程，利用少量的特征和简单的模型或规则对候选集快速筛选，减少后面排序阶段的时间开销。

- 召回和排序有如下特点：
    - 召回层：候选集规模大、模型和特征简单、速度快，尽量保证用户感兴趣数据多召回。
    - 排序层：候选集不大，目标是保证排序的精准，一般使用复杂和模型和特征。

- 在设计召回层时，需要同时考虑召回率和计算速度，既要召回用户感兴趣数据，又要召回热点和时效性数据，如果一次同时召回，那么时间开销会是问题。这时候，一般考虑多路召回。

![](/img/note/202402041757.png)

## 召回模型的演化关系

- 召回模型经历了传统协同过滤到embedding模型化召回的演变，下图是召回技术的演变图。

![](/img/note/202402041801.jpeg)

### 传统召回算法

#### CF（Collaborative Filtering，协同过滤）

- **UserCF直观上比较好理解，就是找一群相似用户，把相似用户喜欢的物品推荐给目标用户**。UserCF更适合新闻推荐场景。在新闻推荐场景中，新闻的兴趣点一般比较分散，比如虎嗅的新闻一般受众群体是从事IT的人，而UserCF可以快速找到都是从事IT的人群，然后把虎嗅的新闻推荐给自己。

- **ItemCF是基于物品相似度进行推荐的协同过滤算法。具体讲，通过计算Item之间的相似度，得到Item相似度矩阵，然后找到用户历史正反馈物品的相似物品进行排序和推荐**。ItemCF更适合电商或视频推荐场景。在电商和视频推荐场景中，都有一个共同点，用户的兴趣比较稳定。比如在电商场景，ItemCF可以推荐和兴趣点相似的商品，比如以前经常购买球鞋的人，可以推荐球衣球裤。

![](/img/note/202402041802.png)


#### 基于矩阵分解的召回算法

- 分解出来的用户矩阵和物品矩阵计算用户和物品的相似度，但是计算复杂度高，对于物品上百万的互联网行业是无法接受的。另外，SVD对于稀疏的共现矩阵也不友好，需要人为填充缺失值，而互联行业用户行为大多是比较稀疏的。

![](/img/note/202402041803.png)

#### 传统召回算法总结
- 传统召回算法有其简单、可解释性强的特点，但是也有自身的局限性。协同过滤和矩阵分解都没有加入用户、物品和上下文相关的特征，也没有考虑用户行为之间的相关性。

### Embedding召回基本框架

#### i2i 召回

- 离线根据用户历史行为训练召回模型，输出item embedding，存储到数据库中
- 线上接受用户请求，根据用户历史行为，从数据库从查找对应的embedding，然后检索相似度最高的n个item，最后将Top n召回结果返回给后面的排序模块。

![](/img/note/202402082035.png)


#### u2i 召回

- 如果召回模型能够直接推断出user embedding和item embedding，那么就可以直接计算二者的相似度，然后进行召回。
- 在u2i召回框架中，有时考虑到用户规模太大，不方便存储，可以在线上召回的时候，直接通过模型请求获取user embedding，然后再检索相似item。
- u2i的召回框架，和i2i相比，主要区别在于u2i可以直接基于user embedding进行检索。

![](/img/note/202402082036.png)


